From 0dac59886c73152d697d296e9616011d64f1608f Mon Sep 17 00:00:00 2001
From: uib15788 <hong.2.yang@continental-corporation.com>
Date: Thu, 11 May 2023 16:36:04 +0800
Subject: [PATCH 1/1] set a53 status function

Signed-off-by: uib15788 <hong.2.yang@continental-corporation.com>
---
 plat/nxp/s32/s32g/s32g_bl2_el3.c | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/plat/nxp/s32/s32g/s32g_bl2_el3.c b/plat/nxp/s32/s32g/s32g_bl2_el3.c
index 9823aea..3306b8f 100755
--- a/plat/nxp/s32/s32g/s32g_bl2_el3.c
+++ b/plat/nxp/s32/s32g/s32g_bl2_el3.c
@@ -26,6 +26,7 @@
 #include <drivers/nxp/s32/ddr/ddr_lp.h>
 #endif
 #include "SRAM_address.h"
+#include <lib/perf_boot_info.h>

 #define PERF_SYS_RESET_REASON     2
 #define PERF_SYS_S2R_REASON       1
@@ -97,6 +98,7 @@ void bl2_el3_early_platform_setup(u_register_t arg0, u_register_t arg1,

 	reset_cause = get_reset_cause();
 	clear_reset_cause();
+	set_a53_status(WAKEUP_STATUS, reset_cause);

 	if (reset_cause == PERF_SYS_S2R_REASON) {
 		// enable uart output in bl2 when resume for better debug
@@ -190,13 +192,17 @@ void bl2_el3_plat_arch_setup(void)
 	if ( reset_cause == PERF_SYS_RESET_REASON)
 	{
 		NOTICE("ddr do not should init\n");
+		set_a53_status(DDR_STATUS, DDR_NO_NEED_INIT);
 	}
 	else
 	{
 		NOTICE("ddr do init\n");
 		ret = ddr_init();
-		if (ret)
+		if (ret) {
+			set_a53_status(DDR_STATUS, DDR_INIT_FAILED);
 			panic();
+		}
+		set_a53_status(DDR_STATUS, DDR_INIT_PASS);
 	}

 #if (ERRATA_S32_050543 == 1)
--
2.17.1
